/* Base reset & typography */
* { box-sizing: border-box; }
html, body, #root { height: 100%; margin: 0; padding: 0; }
body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; -webkit-font-smoothing: antialiased; }

:root {
  --bg: #101317;
  --bg-alt: #14191e;
  --panel-bg: #1b2229;
  --status-bg: #14191e;
  --editor-surface: #1e252d;
  --border: #2a323a;
  --border-strong: #3a4651;
  --editor-border: #2f3942;
  --text: #e2e8ef;
  --text-dim: #8a98a6;
  --accent: #3d82f6;
  --accent-hover: #1d6fe8;
  --danger: #ef5350;
  --shadow: 0 2px 6px rgba(0,0,0,0.45);
  --btn-bg: #262f38;
  --btn-bg-active: #31404d;
  --btn-border: #34414d;
  --tab-bg: #242d35;
  --tab-bg-active: #1e252d;
  --tab-border: #2d3741;
}

body { background: var(--bg); color: var(--text); }

.app-shell { display: flex; flex-direction: column; height: 100%; }
.top-bar { display: flex; align-items: center; gap: 8px; padding: 4px 10px; border-bottom: 1px solid var(--border); background: var(--bg-alt); box-shadow: var(--shadow); }
.top-bar strong { font-weight: 600; letter-spacing: .5px; }

button { font: inherit; }
.btn { background: var(--btn-bg); border: 1px solid var(--btn-border); color: var(--text); padding: 4px 10px; border-radius: 4px; cursor: pointer; line-height: 1.2; display: inline-flex; align-items: center; gap: 4px; }
.btn:hover { background: var(--btn-bg-active); }
.btn.accent { background: var(--accent); border-color: var(--accent); color: #fff; }
.btn.accent:hover { background: var(--accent-hover); }

.workspace { flex: 1; display: flex; overflow: hidden; }
.workspace.modern-shell { display: flex; align-items: stretch; }
.sidebar-outer { width: 240px; border-right: 1px solid var(--border); background: var(--panel-bg); display: flex; flex-direction: column; overflow: hidden; }
.center-stack { flex: 1; min-width: 0; display: flex; flex-direction: column; background: var(--panel-bg); }
.tab-bar { height: 36px; display: flex; align-items: flex-end; padding: 0 8px; gap: 4px; background: linear-gradient(var(--bg-alt), var(--panel-bg)); border-bottom: 1px solid var(--border); }
.tab { position: relative; background: var(--tab-bg); padding: 6px 14px 5px; border: 1px solid var(--tab-border); border-bottom: none; border-top-left-radius: 6px; border-top-right-radius: 6px; font-size: 12px; color: var(--text-dim); cursor: default; display: flex; align-items: center; gap: 6px; }
.tab.active { background: var(--tab-bg-active); color: var(--text); font-weight: 500; box-shadow: 0 -1px 4px rgba(0,0,0,0.04); }
.dirty-dot { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; margin-left: 2px; }
.editor-wrapper.single-pane { background: var(--editor-surface); border-left: 1px solid var(--editor-border); border-right: 1px solid var(--editor-border); }
.editor-column { flex: 2; min-width: 0; display: flex; flex-direction: column; }
.editor-wrapper { flex: 1; min-height: 0; border-bottom: 1px solid var(--editor-border); }
.panel-tabs { display: flex; gap: 4px; padding: 3px 6px; border-top: 1px solid var(--border); background: var(--bg-alt); box-shadow: inset 0 1px 0 var(--border); }
.panel-tabs button { background: transparent; border: 1px solid var(--border); padding: 3px 8px; border-radius: 4px; font-size: 12px; color: var(--text-dim); }
.panel-tabs button.active { background: var(--btn-bg-active); color: var(--text); font-weight: 500; }
.panel-area { flex: 1; overflow: hidden; background: var(--panel-bg); border-top: 1px solid var(--border); }

.sidebar { width: 340px; border-left: 1px solid var(--border); background: var(--panel-bg); display: flex; flex-direction: column; }
.sidebar-header { padding: 6px 10px; font-size: 12px; font-weight: 600; border-bottom: 1px solid var(--border); background: var(--bg-alt); letter-spacing: .5px; }
.sidebar-body { padding: 8px 10px; font-size: 12px; overflow: auto; line-height: 1.5; }
.status-footer { font-size: 12px; padding: 4px 10px; border-top: 1px solid var(--border); display: flex; gap: 18px; background: var(--status-bg); font-family: ui-monospace, SFMono-Regular, Menlo, monospace; }

.mono { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; }
.truncate { max-width: 420px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* Scrollbars */
* { scrollbar-width: thin; scrollbar-color: var(--border) transparent; }
*::-webkit-scrollbar { width: 10px; height: 10px; }
*::-webkit-scrollbar-track { background: transparent; }
*::-webkit-scrollbar-thumb { background: var(--border); border-radius: 6px; border: 2px solid var(--panel-bg); }
*::-webkit-scrollbar-thumb:hover { background: var(--border-strong); }

/* Utility */
.grow { flex: 1; }

/* Diagnostic highlight */
.monaco-editor .diag-highlight { background: rgba(255, 99, 71, 0.25); outline: 1px solid rgba(255,99,71,0.55); border-radius: 2px; }
.monaco-editor .diag-highlight-inline { background: rgba(255, 99, 71, 0.15); }

/* Preview panel */
.preview-root { line-height: 1.55; }
.preview-root .pv-line { padding: 2px 0; }
.preview-root .pv-scene { padding: 4px 0; font-weight: 600; letter-spacing: .5px; color: var(--accent); }
.preview-root .pv-blank { height: 8px; }

/* File list */
.file-list-root { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.fl-header { padding: 6px 10px; font-size: 11px; font-weight: 600; letter-spacing: .5px; border-bottom: 1px solid var(--border); background: var(--bg-alt); }
.fl-tree { list-style: none; margin: 0; padding: 8px 10px; font-size: 12px; line-height: 1.4; overflow: auto; flex: 1; }
.fl-tree ul { list-style: none; margin: 4px 0 4px 14px; padding: 0; }
.fl-world, .fl-story, .fl-narrative { cursor: default; padding: 2px 4px; border-radius: 4px; }
.fl-story.active, .fl-narrative.active { background: var(--tab-bg); color: var(--text); }
.fl-empty { padding: 16px; font-size: 12px; border-top: 1px solid var(--border); }
